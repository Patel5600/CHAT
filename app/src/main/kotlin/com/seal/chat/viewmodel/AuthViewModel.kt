package com.seal.chat.viewmodel\n\nimport androidx.lifecycle.ViewModel\nimport androidx.lifecycle.viewModelScope\nimport kotlinx.coroutines.flow.MutableStateFlow\nimport kotlinx.coroutines.flow.StateFlow\nimport kotlinx.coroutines.flow.asStateFlow\nimport kotlinx.coroutines.launch\n\ndata class AuthState(\n    val isLoading: Boolean = false,\n    val error: String? = null,\n    val email: String? = null,\n    val isOtpSent: Boolean = false,\n    val isAuthenticated: Boolean = false,\n    val userId: String? = null,\n    val token: String? = null\n)\n\nclass AuthViewModel : ViewModel() {\n    private val _authState = MutableStateFlow(AuthState())\n    val authState: StateFlow<AuthState> = _authState.asStateFlow()\n\n    fun sendOtp(email: String) {\n        viewModelScope.launch {\n            _authState.value = _authState.value.copy(isLoading = true, error = null)\n            try {\n                // Simulate API call - in production, call backend\n                kotlinx.coroutines.delay(1500)\n                _authState.value = _authState.value.copy(\n                    isLoading = false,\n                    email = email,\n                    isOtpSent = true\n                )\n            } catch (e: Exception) {\n                _authState.value = _authState.value.copy(\n                    isLoading = false,\n                    error = e.message ?: \"Failed to send OTP\"\n                )\n            }\n        }\n    }\n\n    fun verifyOtp(email: String, otp: String) {\n        viewModelScope.launch {\n            _authState.value = _authState.value.copy(isLoading = true, error = null)\n            try {\n                // Simulate API call - in production, call backend\n                kotlinx.coroutines.delay(1500)\n                \n                // Mock verification - in production, verify with backend\n                if (otp == \"123456\") {\n                    _authState.value = _authState.value.copy(\n                        isLoading = false,\n                        isAuthenticated = true,\n                        userId = \"user-${System.currentTimeMillis()}\",\n                        token = \"mock-token-${System.currentTimeMillis()}\"\n                    )\n                } else {\n                    _authState.value = _authState.value.copy(\n                        isLoading = false,\n                        error = \"Invalid OTP. Try 123456 for demo.\"\n                    )\n                }\n            } catch (e: Exception) {\n                _authState.value = _authState.value.copy(\n                    isLoading = false,\n                    error = e.message ?: \"Failed to verify OTP\"\n                )\n            }\n        }\n    }\n\n    fun logout() {\n        _authState.value = AuthState()\n    }\n\n    fun resetError() {\n        _authState.value = _authState.value.copy(error = null)\n    }\n}\n"
